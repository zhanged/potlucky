<% if flash[:new_gather_modal]  %>
<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
				<h4 class="modal-title" id="myModalLabel"><%= Gather.where(user_id: current_user.id).first.activity %> created!</h4>
			</div>
			<div class="modal-body">
				<% flash.each do |key, value| %>
					<% if value != true %>
						<div class="center alert alert-<%= key %>"><%= value %></div>
					<% end %>
				<% end %>
				<% if Gather.where(user_id: current_user.id).first.tilt > Gather.where(user_id: current_user.id).first.num_invited %>
					<div class="invite-more-friends">Invite <%= Gather.where(user_id: current_user.id).first.tilt - Gather.where(user_id: current_user.id).first.num_invited %>+ more friends:</div>
				<% else %>
					<div class="invite-more-friends">Invite more friends:</div>
				<% end %>
				<div id="text_link">
					<!-- <b>Invite friends via SMS:</b> -->
					<%= form_for(User.new) do |f| %>
						<%= render 'shared/error_messages', object: f.object %>
						<div class="add-by-text-phone"><%= f.text_field :phone, placeholder: "Friend's Mobile Number", :autofocus => true %></div>
						<%= f.hidden_field :gathering_id, value: Gather.where(user_id: current_user.id).first.id %>
						<%= f.submit "Add", data: { disable_with: '...' }, class: "btn btn-large btn-block add-by-phone-btn" %>						
					<% end %>
					<%= form_for(User.new) do |f| %>
						<div class="add-by-text-phone-disabled"><%= f.text_field :phone, disabled: true, placeholder: "Friend's Mobile Number", :autofocus => true %></div>
						<%= f.submit "Add", disabled: true, data: { disable_with: '...' }, class: "btn btn-large btn-block add-by-phone-btn-disabled" %>						
					<% end %>
					<div class="modal-min">If <%= Gather.where(user_id: current_user.id).first.tilt %> friends join, we'll put you in a group chat</div>
				</div>
				<% if Gather.where(user_id: current_user.id).first.invitees.count > 1 %>
					<div class="invited-name-title">Invited:</div>
					<% Gather.where(user_id: current_user.id).first.invitees.each do |user| %>
							<div class="invited-name"><i class="fa fa-check-circle"></i> <%= user.name %></div>
					<% end %>
				<% end %>
				<!-- <div class="modal-body-text">Invite more friends:</div> -->
				<!-- <div class="share-button">
					<i class="fa fa-mobile"></i>&nbsp; Text
				</div> -->
								
			</div> 
			<div class="modal-footer">
				<a href="#" onclick="toggle_visibility('copy_link')">
					<div class="share-button">
					<i class="fa fa-link"></i>&nbsp; Link
					</div>
				</a>
				<a onclick="myFunction('https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fbloon.us/<%= Gather.where(user_id: current_user.id).first.gen_link %>')" href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fbloon.us/<%= Gather.where(user_id: current_user.id).first.gen_link %>" target="_blank">
 					<div class="share-button fb"><%= image_tag("fb_share.png") %>Share</div>
				</a>
				<script type="text/javascript">
					function myFunction(link) {
					window.open(link, 'facebook_share', 'height=320, width=640, toolbar=no, menubar=no, scrollbars=no, resizable=no, location=no, directories=no, status=no');
					}
				</script>
				<div id="copy_link" style="display:none;" class="copy-paste">
					<b>Copy & Paste:</b>
					<textarea onclick="this.select();" /><%= Gather.where(user_id: current_user.id).first.activity %>? We'll only do it if <%= Gather.where(user_id: current_user.id).first.tilt %>+ join. Just let me know here: bloon.us/<%= Gather.where(user_id: current_user.id).first.gen_link %></textarea>
				</div>
				<!-- <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
				<button type="button" class="btn btn-primary">Save changes</button> -->
			</div>
		</div>
	</div>
</div>
<% end %>